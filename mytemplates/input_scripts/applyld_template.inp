{% extends "input_scripts/generic_charmm_script.inp" %} blankme

{% block title %}Langevin Dynamics {% endblock %}

{% block body %} blankme
   {% include 'input_scripts/solvate_implicity.inp' %}

   {% if dopbc %} blankme
      ! read crystal dimensional data from the crystal structure made in solvation
      {% include 'input_scripts/setup_pbc.inp' %}
   {% endif %} blankme

   ! set friction for langevin dynamics
   scalar fbeta set {{fbeta}}

   {% if usesgld %}
     open write unit 41 card name sgld-{{identifier}}.res
     open write unit 31 unfo name sgld-{{identifier}}.dcd
   {% else %}
     open write unit 41 card name ld-{{identifier}}.res
     open write unit 31 unfo name ld-{{identifier}}.dcd
   {% endif %}

   dyna lang leap strt -
   CHARMM-scripts  nstep {{nstep}} timestep 0.001 nprint 100 iprfrq 100 - ! run {{nstep}} steps with a 1 fs timestep
   CHARMM-scripts  iunwri 41 iuncrd 31 nsavc 100 - ! write restart and coordinate trajectory files
   CHARMM-scripts  tbath 300 firstt 300 tstruct 300 - ! run in a 300K heat bath
   {% if usesgld %} blankme
      CHARMM-scripts  sgld tsgavf {{tsgavg}} tempsg {{tempsg}} - ! turn on sgld; tsgavg sets local averaging time (ps) and tempsg sets guiding temp (K)
   {% endif %} blankme
   CHARMM-scripts  iasors 1 iasvel 1 iscvel 0 echeck 500. ! handle initial velocity assignment and bail out if energy changes by > 500 kcal/mol step to step

   {% include 'input_scripts/write_out_struct.inp' %}
{% endblock %} blankme

