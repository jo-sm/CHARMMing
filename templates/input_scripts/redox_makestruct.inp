* this is for redox calculations only
*

read rtf card name {{rtf}}
read param card name {{prm}}

{% for seg in segs %} blankme
  open unit 20 read card name redox-{{id}}-{{seg}}{{suffix}}.pdb
  read sequ pdb unit 20
  generate {{seg}} setup

  close unit 20
{% endfor %} blankme

{% if needpatch %}
  {% for red in reds %}
     patch {{red.presname}} {{red.segresid}} setup
  {% endfor %}
{% endif %}

{% for seg in segs %} blankme
  open unit 20 read card name redox-{{id}}-{{seg}}{{suffix}}.pdb

  {% if forloop.first %} blankme
    read coor pdb unit 20
  {% else %} blankme
    read coor pdb append unit 20
  {% endif %} blankme

  close unit 20
{% endfor %} blankme

ic param
ic fill preserve
ic build

hbuild

write psf card name {{outname}}.psf
* PSF
*

write coor card name {{outname}}.crd
* CRD
*

stop
